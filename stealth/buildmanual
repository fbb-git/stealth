#!/usr/bin/icmake -qt/tmp/stealthmanual

void make_html(list all)
{
    int idx;

    chdir("Yodl");

    for (idx = sizeof(all); idx--; )
    {
        if (element(idx, all) younger "../html/stealth08.html")
        {
            system("yodl2html stealth");
            system("mv *.html ../html");
            system("ln -sf stealth.html ../html/index.html");
            break;
        }
    }
    chdir("..");    
    printf("OK: html\n");
}

void make_LaTeX(list all)
{
    int idx;
    int rept;

    chdir("Yodl");

    for (idx = sizeof(all); idx--; )
    {
        if (element(idx, all) younger "../LaTeX/stealth.latex")
        {
            system("yodl2latex stealth");
            system("mv *.latex ../LaTeX");

            chdir("../LaTeX");

            system(P_NOCHECK, "latex stealth.latex");
            system(P_NOCHECK, "latex stealth.latex");
            system("latex stealth.latex");
            break;
        }
    }

    chdir("..");    
    printf("OK: LaTeX\n");
}

void make_Ps()
{
    int idx;
    int rept;

    chdir("LaTeX");

    if ("stealth.dvi"  younger "../ps/stealth.ps")
        system("dvips -o ../ps/stealth.ps stealth.dvi");

    chdir("..");    
    printf("OK: PostScript\n");
}

void make_Pdf()
{
    int idx;
    int rept;

    chdir("ps");

    if ("stealth.ps"  younger "../pdf/stealth.pdf")
        system("ps2pdf stealth.ps ../pdf/stealth.pdf");

    chdir("..");    
    printf("OK: PDF\n");
}

void make_Text(list all)
{
    int idx;
    int rept;

    chdir("Yodl");

    for (idx = sizeof(all); idx--; )
    {
        if (element(idx, all) younger "../text/stealth.txt")
        {
            system("yodl2txt stealth");
            system("mv *.txt ../text");
            break;
        }
    }

    chdir("..");    
    printf("OK: Text\n");
}

void main()
{
    list all;

    chdir("manual");

    system("mkdir -p html LaTeX pdf ps text");

    chdir("Yodl");

    all = makelist("*") + makelist("*/*");
    chdir("..");
   
    make_html(all);
    make_Text(all);    
    make_LaTeX(all);
    make_Ps();
    make_Pdf();
    exit(0);
}



